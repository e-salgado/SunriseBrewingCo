<!DOCTYPE html>
<html lang="en" ng-app="shippingApp">

<head>

    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index,follow">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <link rel="stylesheet" href="./style/checkout.css">
    <title>Shipping</title>
</head>

<style>
    body{
        -webkit-animation: opening 1s ease-in-out;
        animation: opening 1s ease-in-out;
        background: -webkit-gradient(linear, left top, left bottom, from(black), to(transparent)), url("../img/hero-img.jpg");
        background: linear-gradient(black, transparent), url("../img/hero-img.jpg");
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        background-attachment: fixed;
        color: #fff;
    }
    input[type="radio"] {
        -webkit-appearance: none; /* For Webkit browsers */
        -moz-appearance: none; /* For Mozilla browsers */
        appearance: none; /* Standard property */
        background-color: #fff; /* Default background color when unchecked */
    }
    input[type="radio"]:checked {
        background-color: #E3B23C; /* Background color when checked */
        border-color: #E3B23C; /* Border color when checked */
}
    .btn-primary{
        background: #E3B23C;
        border: none;
    }
    .btn-primary:hover{
        background: #6E675F;
    }
    .btn-primary:focus{
        background: #6E675F;
    }
    .badge{
        background-color: #E3B23C;
    }
    .list-inline li a{
        text-decoration: none;
        color: #E3B23C;
    }
	.error-message {
        color: #dc3545;
        font-size: 0.875em;
        margin-top: 0.25rem;
    }
    .form-label.required:after {
        content: " *";
        color: #dc3545;
    }
    .validation-summary {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        border-radius: 0.375rem;
        color: #721c24;
        padding: 0.75rem 1.25rem;
        margin-bottom: 1rem;
    }
</style>

	
<body> 
	
    <div class="container" ng-controller= "CheckoutCtrl as vm">
        <main>
            <div class="py-5 text-center">
                <h1 class="h2">Shipping form</h1>
            </div>
                <div class="col-md-7 col-lg-8">
                    <h4 class="mb-3">Shipping Address</h4>
					<!-- validation summary-->
					<div class="validation-summary" ng-show="shippingForm.$submitted && shippingForm.$invalid">
                        <h5>Please fix the following errors:</h5>
                        <ul class="mb-0">
                            <li ng-show="shippingForm.firstName.$error.required">First name is required</li>
                            <li ng-show="shippingForm.lastName.$error.required">Last name is required</li>
                            <li ng-show="shippingForm.email.$error.required">Email is required</li>
                            <li ng-show="shippingForm.email.$error.email">Please enter a valid email address</li>
                            <li ng-show="shippingForm.address.$error.required">Address is required</li>
                            <li ng-show="shippingForm.country.$error.required">Country is required</li>
                            <li ng-show="shippingForm.state.$error.required">State is required</li>
                            <li ng-show="shippingForm.zip.$error.required">Zip code is required</li>
                            <li ng-show="shippingForm.zip.$error.pattern">Zip code must be 5 digits</li>
                        </ul>
                    </div>
					
                    <form name="shippingForm" class="needs-validation" novalidate ng-submit="vm.submitForm(shippingForm)">
                        <div class="row g-3">
                            <!-- First Name -->
                            <div class="col-sm-6">
                                <label for="firstName" class="form-label required">First name</label> 
                                <input type="text" class="form-control" id="firstName" name="firstName" 
                                    placeholder="" required ng-model="vm.firstName" ng-minlength="2" ng-maxlength="50">
                                <div class="error-message" ng-show="shippingForm.firstName.$touched && shippingForm.firstName.$error.required">
                                    First name is required.
                                </div>
                                <div class="error-message" ng-show="shippingForm.firstName.$touched && shippingForm.firstName.$error.minlength">
                                    First name must be at least 2 characters.
                                </div>
                                <div class="error-message" ng-show="shippingForm.firstName.$touched && shippingForm.firstName.$error.maxlength">
                                    First name cannot exceed 50 characters.
                                </div>
                            </div>
							
                            <!-- Last Name -->
                            <div class="col-sm-6">
                                <label for="lastName" class="form-label required">Last name</label> 
                                <input type="text" class="form-control" id="lastName" name="lastName" 
                                    placeholder="" required ng-model="vm.lastName" ng-minlength="2" ng-maxlength="50">
                                <div class="error-message" ng-show="shippingForm.lastName.$touched && shippingForm.lastName.$error.required">
                                    Last name is required.
                                </div>
                                <div class="error-message" ng-show="shippingForm.lastName.$touched && shippingForm.lastName.$error.minlength">
                                    Last name must be at least 2 characters.
                                </div>
                                <div class="error-message" ng-show="shippingForm.lastName.$touched && shippingForm.lastName.$error.maxlength">
                                    Last name cannot exceed 50 characters.
                                </div>
                            </div>
                            
							
                            <!-- Email -->
                            <div class="col-12">
                                <label for="email" class="form-label required">Email</label> 
                                <input type="email" class="form-control" id="email" name="email"
                                    placeholder="you@example.com" required ng-model="vm.email">
                                <div class="error-message" ng-show="shippingForm.email.$touched && shippingForm.email.$error.required">
                                    Email is required.
                                </div>
                                <div class="error-message" ng-show="shippingForm.email.$touched && shippingForm.email.$error.email">
                                    Please enter a valid email address.
                                </div>
                            </div>
                            <!-- Address 1 -->
                            <div class="col-12">
                                <label for="address" class="form-label required">Address</label> 
                                <input type="text" class="form-control" id="address" name="address" 
                                    placeholder="Address 1" required ng-model="vm.AddressOne">
                                <div class="error-message" ng-show="shippingForm.address.$touched && shippingForm.address.$error.required">
                                    Please enter your shipping address.
                                </div>
                            </div>
                            <!-- Address 2 -->
                            <div class="col-12">
                                <label for="address2" class="form-label">Address 2 <span class="text-body-secondary">(Optional)</span></label> 
                                <input type="text" class="form-control" id="address2" name="address2" 
                                    placeholder="Apartment or suite" ng-model="vm.AddressTwo">
                            </div>
							
                            <!-- Country -->
                            <div class="col-md-5">
                                <label for="country" class="form-label required">Country</label> 
                                <select class="form-select" id="country" name="country" required ng-model="vm.country">
                                    <option value="">Choose...</option>
                                    <option>United States</option>
                                </select>
                                <div class="error-message" ng-show="shippingForm.country.$touched && shippingForm.country.$error.required">
                                    Please select a valid country.
                                </div>
                            </div>
							<!-- State -->
                            <div class="col-md-4">
								<label for="state" class="form-label required">State</label> 
								<select class="form-select" id="state" name="state"required ng-model="vm.state">
								
                                    <option value="">Select a State</option>
                                    <option value="AL">Alabama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="DC">District of Columbia</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="VA">Virginia</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                                <div class="error-message" ng-show="shippingForm.state.$touched && shippingForm.state.$error.required">
                                    Please provide a valid state.
                                </div>
                            </div>  
							<!-- ZIP -->
                            <div class="col-md-3">
                                <label for="zip" class="form-label required">Zip</label> 
                                <input type="text" class="form-control" id="zip" name="zip" 
                                    placeholder="" required ng-model="vm.zip" ng-pattern="/^[0-9]{5}$/">
                                <div class="error-message" ng-show="shippingForm.zip.$touched && shippingForm.zip.$error.required">
                                    Zip code is required.
                                </div>
                                <div class="error-message" ng-show="shippingForm.zip.$touched && shippingForm.zip.$error.pattern">
                                    Zip code must be 5 digits.
                                </div>
                            </div>
                        </div>
                        <!-- Shipping -->
                        <div class="form-check">
                            <hr class="my-4">
                            <h4 class="mb-3">Select Carrier (US Only)</h4>
                            <input class="form-check-input" type="radio" name="shippingMethod" id="radioDefault1" 
                                ng-model="vm.shipping" value="USPS" required>
                            <label class="form-check-label" for="radioDefault1">
                                <h5 class="mb-3">USPS Standard (3-5 Business Days)</h5>
                                <p class="shipping-price">Free</p>
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="shippingMethod" id="radioFedEx2Day" 
                                ng-model="vm.shipping" value="FedEx2Day" required>
                            <label class="form-check-label" for="radioFedEx2Day">
                                <h5 class="mb-3">Fedex Express (Two Day)</h5>
                                <p class="shipping-price">$20.00</p>
                            </label>
						</div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="shippingMethod" id="radioFedExOvernight" 
                                ng-model="vm.shipping" value="FedExOvernight" required>
                            <label class="form-check-label" for="radioFedExOvernight">
                                <h5 class="mb-3">Fedex Express (Overnight)</h5>
                                <p class="shipping-price">$50.00</p>
                            </label>
                        </div>
						<div class="error-message" ng-show="shippingForm.$submitted && !vm.shipping">
                            Please select a shipping method.
							</div>	
                        <hr class="my-4"> <button class="w-100 btn btn-primary btn-lg" type="submit" onclick="toBilling()">Continue to billing</button>
                    </form>
                </div>
            </div>
        </main>
        <footer class="my-5 pt-5 text-body-secondary text-center text-small">
            <p class="mb-3" style="color: #fff;">&copy; 2025 Sunrise Brewing Co</p>
            <ul class="list-inline">
                <li class="list-inline-item"><a href="#">Privacy</a></li>
                <li class="list-inline-item"><a href="#">Terms</a></li>
                <li class="list-inline-item"><a href="#">Support</a></li>
            </ul>
        </footer>
    </div>
	
	<script>
			angular.module('shippingApp', [])
			.controller('CheckoutCtrl', function() {
				var vm = this;

				// Initialize form data
				vm.firstName = '';
				vm.lastName = '';
				vm.email = '';
				vm.AddressOne = '';
				vm.AddressTwo = '';
				vm.country = '';
				vm.state = '';
				vm.zip = '';
				vm.shipping = '';

				vm.submitForm = function(form) {
					if (form) {
						angular.forEach(form.$error, function(field) {
							angular.forEach(field, function(errorField) {
								errorField.$setTouched();
							});
						});
					}

					if (form.$valid && vm.shipping) {
						const formData = {
							type: "shipping",   
							firstName: vm.firstName,
							lastName: vm.lastName,
							email: vm.email,
							address1: vm.AddressOne,
							address2: vm.AddressTwo,
							country: vm.country,
							state: vm.state,
							zip: vm.zip,
							shipping: vm.shipping
						};

						fetch("http://localhost:3000/save-shipping", {  
							method: "POST",
							headers: { "Content-Type": "application/json" },
							body: JSON.stringify(formData)
						})
						.then(res => res.json())
						.then(data => {
							console.log("Saved to CustomerInfo.json:", data);
							alert("Shipping info saved!");
							vm.resetForm && vm.resetForm(form);
						})
						.catch(err => console.error("Error saving data:", err));
					} else {
						console.log("Form has validation errors");
					}
				};
			});

            function toBilling() {
                open("./billing.html")
            };
	</script>
    <script src="/docs/5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        class="astro-vvvwv3sm"></script>
    <script src="checkout.js" class="astro-vvvwv3sm"></script> <wfx-qluqaowbaemi><template
            shadowrootmode="closed"></template></wfx-qluqaowbaemi>
    <script src="./script.js"></script>
</body>